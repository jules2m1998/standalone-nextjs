(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1576],{90635:function(e,i,n){Promise.resolve().then(n.bind(n,97099))},97099:function(e,i,n){"use strict";n.r(i);var t=n(4596);i.default=t.default},4596:function(e,i,n){"use strict";n.r(i);var t=n(57437),s=n(14506),a=n(23615),l=n(49230),r=n(46928),u=n(12593),o=n(16862),d=n(69174),c=n(38038),v=n(23588),p=n(2265),m=n(23377),f=n(46716),y=n(61865),h=n(35691);let b=h.Ry().shape({name:h.Z_().required("This field is required"),isActive:h.O7().optional()}),x=e=>{var i;let{defaultValues:n,onSubmit:s}=e,{handleSubmit:a,register:l,formState:{errors:r},control:u,setValue:o}=(0,y.cI)({resolver:(0,d.X)(b),defaultValues:n});return(0,p.useEffect)(()=>{var e,i;o("isActive",null!==(e=null==n?void 0:n.isActive)&&void 0!==e&&e),o("name",null!==(i=null==n?void 0:n.name)&&void 0!==i?i:"")},[n,o]),(0,t.jsxs)("form",{onSubmit:a(s),style:{display:"grid",gridTemplateColumns:"minmax(300px, 1fr) auto auto",gap:10,alignItems:"flex-end"},children:[(0,t.jsxs)(m.Z.Group,{children:[(0,t.jsx)(m.Z.Label,{children:"Name"}),(0,t.jsx)(m.Z.Control,{...l("name"),defaultValue:null==n?void 0:n.name}),(0,t.jsx)(m.Z.Control.Feedback,{type:"invalid",children:null===(i=r.name)||void 0===i?void 0:i.message})]}),(0,t.jsx)(m.Z.Group,{className:"mb-2",children:(0,t.jsx)(y.Qr,{control:u,name:"isActive",render:e=>{let{field:i}=e;return(0,t.jsx)(m.Z.Switch,{checked:i.value,onChange:()=>i.onChange(!i.value),defaultChecked:null==n?void 0:n.isActive})}})}),(0,t.jsx)(f.Z,{type:"submit",children:n?"Update":"Generate"})]})};i.default=e=>{var i,n,d;let{generate:m=s.HI,update:f=s.a9,notifier:y=o.U0}=e,[h,b]=(0,p.useState)(),{data:C,isFetched:S}=(0,r.vU)(),j=(0,p.useMemo)(()=>{var e,i;return null==C?void 0:null===(i=C.subscription)||void 0===i?void 0:null===(e=i.apiKeys)||void 0===e?void 0:e.find(e=>e.id===h)},[h,null==C?void 0:null===(i=C.subscription)||void 0===i?void 0:i.apiKeys]),k=(0,c.NL)(),A=(0,p.useCallback)(async()=>{await k.invalidateQueries({queryKey:[l.YJ],type:"active"})},[k]),{mutate:N,isPending:g}=(0,v.D)({mutationFn:async e=>{if(!C)return;let i=async()=>{if(!await m(C.id,e))throw Error("UNKNOWN");return"SUCCESS"};await y.toastCreationAsync(i)},onSuccess:A}),{mutate:K,isPending:w}=(0,v.D)({mutationFn:async e=>{let{key:i,id:n}=e;if(!C)return;let t=async()=>{if(!await f(C.id,n,i))throw Error("UNKNOWN");return"SUCCESS"};await y.toastUpdateAsync(t)},onSuccess:A}),E=(0,p.useCallback)(async e=>{j?K({id:j.id,key:e}):N(e)},[j,N,K]),U=(0,p.useCallback)(async e=>{var i,n;let t=null==C?void 0:null===(n=C.subscription)||void 0===n?void 0:null===(i=n.apiKeys)||void 0===i?void 0:i.find(i=>i.id===e);t&&K({id:e,key:{...t,isActive:!t.isActive}})},[K,null==C?void 0:null===(n=C.subscription)||void 0===n?void 0:n.apiKeys]),Z=(0,p.useMemo)(()=>{var e;return null==C?void 0:null===(e=C.roles)||void 0===e?void 0:e.find(e=>e.name===u.GW.API_USER)},[null==C?void 0:C.roles]);return(0,t.jsxs)(t.Fragment,{children:[!!Z&&(0,t.jsxs)("fieldset",{disabled:g||w,children:[(0,t.jsx)(x,{defaultValues:j,onSubmit:E}),!!C&&C.subscription&&!!(null===(d=C.subscription.apiKeys)||void 0===d?void 0:d.length)&&(0,t.jsx)(a.ApiKeyList,{activeKey:h,onSetEdit:b,keys:C.subscription.apiKeys,onActivate:U})]}),!Z&&S&&(0,t.jsx)("p",{children:"This user is not an api user"})]})}}},function(e){e.O(0,[8218,9461,6990,1866,9571,2135,4562,9460,6349,461,1103,2639,4037,8093,6691,5704,5864,7176,5691,1281,6402,2749,6375,4102,7160,5152,5377,9704,2971,4938,1744],function(){return e(e.s=90635)}),_N_E=e.O()}]);
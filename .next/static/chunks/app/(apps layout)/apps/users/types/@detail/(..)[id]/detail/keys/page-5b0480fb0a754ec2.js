(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7595],{47487:function(e,i,n){Promise.resolve().then(n.bind(n,4596))},4596:function(e,i,n){"use strict";n.r(i);var s=n(57437),t=n(14506),l=n(23615),a=n(49230),r=n(46928),o=n(12593),u=n(16862),d=n(69174),c=n(38038),v=n(23588),p=n(2265),m=n(23377),y=n(46716),f=n(61865),h=n(35691);let b=h.Ry().shape({name:h.Z_().required("This field is required"),isActive:h.O7().optional()}),x=e=>{var i;let{defaultValues:n,onSubmit:t}=e,{handleSubmit:l,register:a,formState:{errors:r},control:o,setValue:u}=(0,f.cI)({resolver:(0,d.X)(b),defaultValues:n});return(0,p.useEffect)(()=>{var e,i;u("isActive",null!==(e=null==n?void 0:n.isActive)&&void 0!==e&&e),u("name",null!==(i=null==n?void 0:n.name)&&void 0!==i?i:"")},[n,u]),(0,s.jsxs)("form",{onSubmit:l(t),style:{display:"grid",gridTemplateColumns:"minmax(300px, 1fr) auto auto",gap:10,alignItems:"flex-end"},children:[(0,s.jsxs)(m.Z.Group,{children:[(0,s.jsx)(m.Z.Label,{children:"Name"}),(0,s.jsx)(m.Z.Control,{...a("name"),defaultValue:null==n?void 0:n.name}),(0,s.jsx)(m.Z.Control.Feedback,{type:"invalid",children:null===(i=r.name)||void 0===i?void 0:i.message})]}),(0,s.jsx)(m.Z.Group,{className:"mb-2",children:(0,s.jsx)(f.Qr,{control:o,name:"isActive",render:e=>{let{field:i}=e;return(0,s.jsx)(m.Z.Switch,{checked:i.value,onChange:()=>i.onChange(!i.value),defaultChecked:null==n?void 0:n.isActive})}})}),(0,s.jsx)(y.Z,{type:"submit",children:n?"Update":"Generate"})]})};i.default=e=>{var i,n,d;let{generate:m=t.HI,update:y=t.a9,notifier:f=u.U0}=e,[h,b]=(0,p.useState)(),{data:C,isFetched:S}=(0,r.vU)(),j=(0,p.useMemo)(()=>{var e,i;return null==C?void 0:null===(i=C.subscription)||void 0===i?void 0:null===(e=i.apiKeys)||void 0===e?void 0:e.find(e=>e.id===h)},[h,null==C?void 0:null===(i=C.subscription)||void 0===i?void 0:i.apiKeys]),k=(0,c.NL)(),A=(0,p.useCallback)(async()=>{await k.invalidateQueries({queryKey:[a.YJ],type:"active"})},[k]),{mutate:N,isPending:g}=(0,v.D)({mutationFn:async e=>{if(!C)return;let i=async()=>{if(!await m(C.id,e))throw Error("UNKNOWN");return"SUCCESS"};await f.toastCreationAsync(i)},onSuccess:A}),{mutate:K,isPending:w}=(0,v.D)({mutationFn:async e=>{let{key:i,id:n}=e;if(!C)return;let s=async()=>{if(!await y(C.id,n,i))throw Error("UNKNOWN");return"SUCCESS"};await f.toastUpdateAsync(s)},onSuccess:A}),E=(0,p.useCallback)(async e=>{j?K({id:j.id,key:e}):N(e)},[j,N,K]),U=(0,p.useCallback)(async e=>{var i,n;let s=null==C?void 0:null===(n=C.subscription)||void 0===n?void 0:null===(i=n.apiKeys)||void 0===i?void 0:i.find(i=>i.id===e);s&&K({id:e,key:{...s,isActive:!s.isActive}})},[K,null==C?void 0:null===(n=C.subscription)||void 0===n?void 0:n.apiKeys]),Z=(0,p.useMemo)(()=>{var e;return null==C?void 0:null===(e=C.roles)||void 0===e?void 0:e.find(e=>e.name===o.GW.API_USER)},[null==C?void 0:C.roles]);return(0,s.jsxs)(s.Fragment,{children:[!!Z&&(0,s.jsxs)("fieldset",{disabled:g||w,children:[(0,s.jsx)(x,{defaultValues:j,onSubmit:E}),!!C&&C.subscription&&!!(null===(d=C.subscription.apiKeys)||void 0===d?void 0:d.length)&&(0,s.jsx)(l.ApiKeyList,{activeKey:h,onSetEdit:b,keys:C.subscription.apiKeys,onActivate:U})]}),!Z&&S&&(0,s.jsx)("p",{children:"This user is not an api user"})]})}}},function(e){e.O(0,[8218,9461,6990,1866,9571,2135,4562,9460,6349,461,1103,2639,4037,8093,6691,5704,5864,7176,5691,1281,6402,2749,6375,4102,7160,5152,5377,9704,2971,4938,1744],function(){return e(e.s=47487)}),_N_E=e.O()}]);